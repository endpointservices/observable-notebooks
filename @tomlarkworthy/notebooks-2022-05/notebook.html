<!doctype html>
<notebook theme="air">
  <title>Top Observablehq Notebooks of May 2022</title>
  <script id="367" type="text/markdown">
    # Top Observablehq Notebooks of May 2022 
  </script>
  <script id="351" type="application/vnd.observable.javascript">
    {
      const notebooks = data
        .map((value) => ({ value, sort: Math.random() }))
        .sort((a, b) => a.sort - b.sort)
        .map(({ value }) => value);
      return htl.html`<table width="100%">${Array.from({
        length: 5
      }).map(
        (__, j) =>
          htl.html.fragment`<tr style="border-bottom: none;">${Array.from({
            length: 4
          }).map((__, i) => {
            const notebook = data[i + j * 4];
            if (notebook === undefined) return;
            return htl.html.fragment`<td style="padding: 0px">
                <a href=${notebook.url} target="_blank" >
                  <img width="100%" src=${notebook.thumbnail}>`;
          })}</tr>`
      )}</table>`;
    }
  </script>
  <script id="0" type="text/markdown">
    ${month} had 4 times more engagement with the [Trending Notebook Bot](https://twitter.com/trendingnotebo2) than April! This is an unprecedented jump in activity! This I think was due to [@waynesutton](https://twitter.com/waynesutton) returning as community manager for Observable (üëã great to have you back Wayne!) and retweeting us a lot. Thanks Wayne, it makes a big impact for us! I had to rescale all my plots to 
    accommodate!

    ${month} had four notebooks in particular broke from the pack this month, each gaining many likes and retweets. I would say we are still waiting for a true viral Tweet authored by the [trending bot](https://twitter.com/trendingnotebo2), but we are getting some close calls!

  </script>
  <script id="15" type="text/markdown">
    ### Engagement, Impressions, Likes and Retweets
  </script>
  <script id="12" type="application/vnd.observable.javascript">
    Plot.plot({
      x: {
        domain: [0, d3.max(data, (d) => d.impressions * 1.2)]
      },
      y: {
        domain: [0, d3.max(data, (d) => d.engagements * 1.3)]
      },
      marks: [
        Plot.image(
          [...data].sort((x) => x.impressions),
          {
            x: "impressions",
            y: "engagements",
            width: "importance",
            title: "title",
            src: "thumbnail"
          }
        ),
        Plot.text(data, {
          text: (d) =>
            Array.from({ length: d.likes })
              .map((_) => "‚ù§Ô∏è")
              .join("") +
            Array.from({ length: d.retweets })
              .map((_) => "üîÅ")
              .join(""),
          x: "impressions",
          y: "engagements"
        })
      ]
    })
  </script>
  <script id="168" type="application/vnd.observable.javascript">
    viewof scaling = Inputs.range([0, 1], { value: 0.09 })
  </script>
  <script id="172" type="application/vnd.observable.javascript">
    viewof offset = Inputs.range([0, 100], { value: 71 })
  </script>
  <script id="304" type="application/vnd.observable.javascript">
    viewof cutoff = Inputs.range([0, data.length], {
      value: 5,
      step: 1,
      label: "cutoff"
    })
  </script>
  <script id="534" type="text/markdown">
    The very top notebook was [Hello MapLibre](https://observablehq.com/@neocartocnrs/hello-maplibre) which had 18 likes and 6 retweets. [@neocartocnrs](https://observablehq.com/@neocartocnrs) is a familiar name in the Map Dataviz and Observable community. [MapLibre](https://maplibre.org/) is the OSS fork of mapbox-gl-js, and requires a little Observable knowhow to get working properly. Creating a _Hello X_ notebook is an Observablehq community norm when getting a new technology into the ecosystem, and MapLibre is a highly desirable dependency for the mapping community. Thus, getting that library working was a big deal, which was eagerly snapped up by the community. Since publishing, we have seen some other notebooks building on the path cut by [@neocartocnrs](https://observablehq.com/@neocartocnrs), for example, [Terrains with MapLibre](https://observablehq.com/@bert/terrains-with-maplibre) by [@bert](https://observablehq.com/@bert).

    The next big hit of the month was written by me! I can tell your that [Interactive Sequence Diagrams](https://observablehq.com/@tomlarkworthy/animated-sequence-diagrams) was a shower thought that struck me at 1a.m. at night. It's an extremely simple technique for creating user steppable sequence diagrams on Observable, which solved a problem I was having with technical documentation. It only took about 15 mins to code up. I was surprised by how well the notebook did on the trending page, leading me to submit it to Hackernews where it reached the front page. That notebook received more traffic than I ususally get in a whole month over all my notebooks. Clearly, Observable has great potential as a technical documentation host.

    Another big notebook of the month was [DarkCideS: Bats in Caves Data](https://observablehq.com/@observablehq/darkcides-bats-in-caves) by the [creators](https://observablehq.com/@observablehq) of Observable. That notebook is simply a stellar example of how to do sophisticated data analysis on the platform. In particular, it makes use of embedded SQL cells to deftly manipulate data and uses Plot to create amazing visualization with very little code. That notebook is my new reference example for canonical Dataviz techniques on Observable. üëè great work Observble team it is a thing of beauty!  

    The final notebook of the months big four was [A Sine-Cosine Encoder Experiment](https://observablehq.com/@skybrian/a-sine-cosine-encoder-experiment) by [@skybrian](https://observablehq.com/@skybrian). It's a wonderful example of doing real engineering at home using consumer equipement (LEGO!), that is just a great read with amazing charts of real data. These kinds of projects work quite well in Computational notebooks because you can easily embed pictures and do the mathematics in a single artifact. It lets you get everything down in a single place that you can refer back to at any time. I hope we see more like this!

    It did not make quite a big a splash as the other notebooks, but I find it quite amusing that the #5 in ${month} was last months *"best-of"* summary notebook! It had to happen eventually. I did tweet the notebook last month, so for the first time a summary notebook made it into [trending](https://observablehq.com/trending), and actually did really well!

    See you next month! Here are the [top trending](https://twitter.com/trendingnotebo2) notebooks of ${month} in their own words.

  </script>
  <script id="278" type="application/vnd.observable.javascript">
    md`${content}`
  </script>
  <script id="275" type="application/vnd.observable.javascript">
    content = {
      debugger;
      let markdown = "";
      for (let i = 0; i < cutoff; i++) {
        const notebook = data[i];
        const author = /(@[^)]+)/.exec(notebook.author)[1];
        markdown += `### [${notebook.title}](${notebook.url}) by [${author}](https://observablehq.com/${author}) \n`;
        markdown += `<i>\n`;
        markdown += `\n[![](${notebook.thumbnail})](${notebook.url})\n`;
        markdown += `\n${notebook?.description || "No description provided"}\n`;
        markdown += `</i>\n`;
        markdown += "\n---\n";
      }

      markdown += `</i>\n`;

      markdown += `These other notebooks also trended in ${month}\n`;
      for (let i = cutoff; i < data.length; i++) {
        const notebook = data[i];
        const author_match = /(@[^)]+)/.exec(notebook.author);
        if (!author_match) {
          debugger;
          throw new Error(JSON.stringify(notebook));
        }
        const author = author_match[1];
        markdown += `#### [${notebook.title}](${notebook.url}) by [${author}](https://observablehq.com/${author}) \n`;
      }

      return markdown;
    }
  </script>
  <script id="422" type="application/vnd.observable.javascript">
    month = "May"
  </script>
  <script id="138" type="application/vnd.observable.javascript">
    data = tweets
      .map((tweet, i) => ({
        ...tweet,
        ...meta[i],
        ...metadata[i],
        ...tags[i],
        thumbnail: thumbnailURL(i),
        importance: tweet.impressions * scaling + offset
      }))
      .sort((a, b) => b.impressions - a.impressions)
  </script>
  <script id="547" type="application/vnd.observable.javascript">
    SKIP = [
      "Notebook of the month (maybe of the year?) by a clear margin was 'Visualizing Air Raid Sirens in Ukraine' by @mourner. Amazing work Volodymyr, thank you.\n\nhttps://t.co/a95BeD8luT"
    ]
  </script>
  <script id="6" type="application/vnd.observable.javascript">
    tweets = (
      await FileAttachment(
        "tweet_activity_metrics_trendingnotebo2_20220501_20220601_en.csv"
      ).csv()
    ).filter(tweet => !SKIP.includes(tweet['Tweet text'])).map((x) => ({
      ...x,
      engagements: parseFloat(x.engagements),
      impressions: parseFloat(x.impressions),
      likes: parseFloat(x.likes),
      retweets: parseFloat(x.retweets)
    }))
  </script>
  <script id="82" type="application/vnd.observable.javascript">
    viewof fetchNotebookURL = Inputs.toggle({
      label: "fetch notebook URL? (network, slow)"
    })
  </script>
  <script id="73" type="application/vnd.observable.javascript">
    expandTwitterURL = async (shortURL) => {
      const response = await fetch(shortURL);
      if (response.status !== 200)
        throw new Error(`fetch to ${shortURL} resulted in ${response.status}`);
      const body = await response.text();
      return /URL=([^"]*)"/.exec(body)[1];
    }
  </script>
  <script id="84" type="application/vnd.observable.javascript">
    fetchedNotebookURL = {
      if (!fetchNotebookURL) return invalidation;
      const notebooks = new Array(tweets.length);
      for (let i = 0; i < tweets.length; i++) {
        const shortcode = /(https:\/\/t.co\/[0-9a-zA-Z]*) https:\/\/t.co\/[0-9a-zA-Z]*$/.exec(
          tweets[i]["Tweet text"]
        );
        if (!shortcode) {
          console.error(tweets[i]);
          throw Error(JSON.stringify(tweets[i]));
        }
        notebooks[i] = expandTwitterURL(shortcode[1]);
      }
      return Promise.all(notebooks);
    }
  </script>
  <script id="104" type="application/vnd.observable.javascript">
    notebookURL = FileAttachment("fetchedNotebookURL (5).json").json()
  </script>
  <script id="65" type="application/vnd.observable.javascript">
    viewof fetchMetdata = Inputs.toggle({
      label: "fetch metadata? (network, slow)"
    })
  </script>
  <script id="67" type="application/vnd.observable.javascript">
    fetchedMetadata = {
      if (!fetchMetdata) return invalidation;

      const metadata = new Array(tweets.length);
      for (let i = 0; i < tweets.length; i++) {
        metadata[i] = await getMetadata(
          notebookURL[i].replace("https://observablehq.com/", "")
        );
      }
      return metadata;
    }
  </script>
  <script id="123" type="application/vnd.observable.javascript">
    metadata = FileAttachment("fetchedMetadata (6).json").json()
  </script>
  <script id="57" type="application/vnd.observable.javascript">
    viewof fetchMeta = Inputs.toggle({
      label: "fetch doc meta? (network, slow)"
    })
  </script>
  <script id="61" type="application/vnd.observable.javascript">
    fetchedMeta = {
      if (!fetchMeta) return invalidation;
      const meta = new Array(tweets.length);
      for (let i = 0; i < tweets.length; i++) {
        if (metadata[i]) {
          meta[i] = (
            await fetchp(
              `https://api.observablehq.com/document/${metadata[i].id}/meta`
            )
          ).json();
        }
      }
      return Promise.all(meta);
    }
  </script>
  <script id="131" type="application/vnd.observable.javascript">
    meta = FileAttachment("fetchedMeta (7).json").json()
  </script>
  <script id="55" type="application/vnd.observable.javascript">
    thumbnailURL = (index) =>
      meta[index]
        ? `https://static.observableusercontent.com/thumbnail/${
            meta[index].custom_thumbnail || meta[index].thumbnail
          }.jpg`
        : undefined
  </script>
  <script id="283" type="application/vnd.observable.javascript">
    viewof fetchTags = Inputs.toggle({
      label: "fetch page meta tags? (network, slow)"
    })
  </script>
  <script id="286" type="application/vnd.observable.javascript">
    fetchedTags = {
      if (!fetchTags) return invalidation;
      var el = document.createElement("tmp");
      const tags = new Array(tweets.length);
      for (let i = 0; i < tweets.length; i++) {
        if (metadata[i]) {
          el.innerHTML = await (await fetchp(metadata[i].url)).text();

          try {
            tags[i] = {
              title: el.querySelector("meta[property='og:title']").content,
              description: el.querySelector("meta[name=description]").content
            };
          } catch (err) {
            console.error("Problem with tags for " + i);
          }
        }
      }
      return tags;
    }
  </script>
  <script id="289" type="application/vnd.observable.javascript">
    tags = (await FileAttachment("fetchedTags (7).json").json()).map((t) => {
      let description = undefined;
      if (t?.description) {
        description = t.description;

        if (description.lastIndexOf(".") !== -1)
          description = description.substring(0, description.lastIndexOf(".") + 1);
      }

      return {
        ...t,
        description
      };
    })
  </script>
  <script id="27" type="application/vnd.observable.javascript">
    import { Plot } from "@mkfreeman/plot-tooltip"
  </script>
  <script id="63" type="application/vnd.observable.javascript">
    import { getMetadata } from "@mootari/notebook-data"
  </script>
  <script id="59" type="application/vnd.observable.javascript">
    import { fetchp } from "@tomlarkworthy/fetchp"
  </script>
  <script id="344" type="application/vnd.observable.javascript">
    import { footer } from "@endpointservices/footer-with-backups"
  </script>
  <script id="347" type="application/vnd.observable.javascript">
    footer
  </script>
</notebook>
