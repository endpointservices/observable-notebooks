<!doctype html>
<notebook theme="air">
  <title>Stripe</title>
  <script id="0" type="application/vnd.observable.javascript">
    html`
    <div class="content">${md`
    # Stripe

    You can do one time payments without a server! Stripe is all you need to collect a shipping address and get realtime notification sent to your phone. On the forum is a discussion on how Observable + Stripe can do [e-retail](https://talk.observablehq.com/t/e-commerce-on-observable-stem-books-for-kids/4555/3). A production shop is [here](https://observablehq.com/@pauseandplay/shop).

    ~~~js
    import {Stripe} from "@tomlarkworthy/stripe" 
    ~~~

    ~~~js
    stripe = Stripe("<API_KEY>")
    ~~~

    Read the real docs and setup an account on [stripe.com](https://stripe.com/docs/payments/checkout/client). Look at the demo button below, click it and see what happens...   
    `}

    ${location.search == "?success"? html`
    <center>
    <h1>Thanks for the Coffee!</h1>
    <img src="${await FileAttachment("nod.webp").url()}"/>
    </center>
    `:null}

    </div>



    `
  </script>
  <script id="57" type="application/vnd.observable.javascript" pinned="">
    html`<center>
      <button class="button is-primary"
              onclick=${() => { 
      stripe.redirectToCheckout({
        lineItems: [{
          price: 'price_1He4G9HGNosi6Ft0RInpHMHu', // ID of your price
          quantity: 1,
        }],
        mode: 'payment',
        successUrl: 'https://observablehq.com/@tomlarkworthy/stripe?success',
        cancelUrl: 'https://observablehq.com/@tomlarkworthy/stripe?cancel',
      });
    }}>â˜• Buy Tom a coffee...</button></center>`
  </script>
  <script id="210" type="application/vnd.observable.javascript">
    html `<img src="${await FileAttachment("pexels-alexander-mils-2068975.jpg").url()}"/><p>Photo by Alexander Mils from Pexels</p>`
  </script>
  <script id="8" type="application/vnd.observable.javascript">
    html `<img src="${await FileAttachment("image.png").url()}"/>`
  </script>
  <script id="170" type="application/vnd.observable.javascript">
    html`<img src="${await FileAttachment("image@2.png").url()}"/>`
  </script>
  <script id="153" type="application/vnd.observable.javascript">
    Stripe = require('https://js.stripe.com/v3/').then(() => window["Stripe"]).catch(() => window["Stripe"])
  </script>
  <script id="6" type="application/vnd.observable.javascript">
    STRIPE_API_KEY = "pk_live_51HbQzcHGNosi6Ft0JM18AKCtG3cIs707E1ft1B5ePvpptHb5yoLnXHXLWkyBbDjHgtlPMOT0233jrcfvWAGj6AYp00RxIZdaky"
  </script>
  <script id="111" type="application/vnd.observable.javascript">
    stripe = Stripe(STRIPE_API_KEY)
  </script>
  <script id="53" type="application/vnd.observable.javascript">
    bulma
  </script>
  <script id="51" type="application/vnd.observable.javascript">
    import {bulma} from '@tomlarkworthy/bulma'
  </script>
  <script id="70" type="application/vnd.observable.javascript">
    import {html} from "@observablehq/htl"
  </script>
  <script id="235" type="application/vnd.observable.javascript">
    import { footer } from "@endpointservices/footer"
  </script>
  <script id="237" type="application/vnd.observable.javascript">
    footer
  </script>
</notebook>
